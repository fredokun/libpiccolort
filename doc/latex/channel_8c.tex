\hypertarget{channel_8c}{\section{src/channel.c File Reference}
\label{channel_8c}\index{src/channel.\-c@{src/channel.\-c}}
}
{\ttfamily \#include $<$channel.\-h$>$}\\*
{\ttfamily \#include $<$tools.\-h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{channel_8c_ade120ac18f176dddff55ddb64af36027}{L\-O\-C\-K\-\_\-\-C\-H\-A\-N\-N\-E\-L}(c)~\hyperlink{sync_8c_ad533486752c5f9d3dd499a06288f31ab}{P\-I\-C\-C\-\_\-acquire}(c-\/$>$lock);
\item 
\#define \hyperlink{channel_8c_aff8dd5b9a61142b55d554342ce512f64}{R\-E\-L\-E\-A\-S\-E\-\_\-\-C\-H\-A\-N\-N\-E\-L}(c)~\hyperlink{sync_8c_a0a6cdd715fc6aba7327880215401fa71}{P\-I\-C\-C\-\_\-release}(c-\/$>$lock, N\-U\-L\-L);
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{channel_8h_a0a70def8883f1abb8e7246b3a4c9dffb}{P\-I\-C\-C\-\_\-\-Channel} $\ast$ \hyperlink{channel_8c_ac6607a30fa1063c40a16c99eece1e54c}{P\-I\-C\-C\-\_\-create\-\_\-channel} (\hyperlink{error_8h_af89348b58191950b36702ace17a79c0b}{P\-I\-C\-C\-\_\-\-Error} $\ast$error)
\item 
\hyperlink{channel_8h_a0a70def8883f1abb8e7246b3a4c9dffb}{P\-I\-C\-C\-\_\-\-Channel} $\ast$ \hyperlink{channel_8c_a34ef7a647bbe6c9d81f7f76edb5931da}{P\-I\-C\-C\-\_\-create\-\_\-channel\-\_\-cn} (int commit\-\_\-size, \hyperlink{error_8h_af89348b58191950b36702ace17a79c0b}{P\-I\-C\-C\-\_\-\-Error} $\ast$error)
\item 
\hyperlink{channel_8h_a87609417467916d98a7505871adc1760}{P\-I\-C\-C\-\_\-\-Knowns} $\ast$ \hyperlink{channel_8c_ab4695da5b9909d70ece6acf9b7393d53}{P\-I\-C\-C\-\_\-create\-\_\-knowns} (\hyperlink{error_8h_af89348b58191950b36702ace17a79c0b}{P\-I\-C\-C\-\_\-\-Error} $\ast$error)
\item 
\hyperlink{channel_8h_ab705fb8d376f852fb1af337ac749c2e3}{P\-I\-C\-C\-\_\-\-Knowns\-Set} $\ast$ \hyperlink{channel_8c_a7dbf43e2a8d14b2fa22ffcac602baa70}{P\-I\-C\-C\-\_\-create\-\_\-knowns\-\_\-set} (int length, \hyperlink{error_8h_af89348b58191950b36702ace17a79c0b}{P\-I\-C\-C\-\_\-\-Error} $\ast$error)
\item 
void \hyperlink{channel_8c_aaed8342d9318af6e44423bfc5ea037d1}{P\-I\-C\-C\-\_\-channel\-\_\-incr\-\_\-ref\-\_\-count} (\hyperlink{channel_8h_a0a70def8883f1abb8e7246b3a4c9dffb}{P\-I\-C\-C\-\_\-\-Channel} $\ast$channel, \hyperlink{error_8h_af89348b58191950b36702ace17a79c0b}{P\-I\-C\-C\-\_\-\-Error} $\ast$error)
\item 
void \hyperlink{channel_8c_a82356d13ea700750660c72bdff7c8d6b}{P\-I\-C\-C\-\_\-channel\-\_\-dec\-\_\-ref\-\_\-count} (\hyperlink{channel_8h_a0a70def8883f1abb8e7246b3a4c9dffb}{P\-I\-C\-C\-\_\-\-Channel} $\ast$channel, \hyperlink{error_8h_af89348b58191950b36702ace17a79c0b}{P\-I\-C\-C\-\_\-\-Error} $\ast$error)
\item 
void \hyperlink{channel_8c_a873aa501ffdedc2f345326b0ae025ec1}{P\-I\-C\-C\-\_\-reclaim\-\_\-channel} (\hyperlink{channel_8h_a0a70def8883f1abb8e7246b3a4c9dffb}{P\-I\-C\-C\-\_\-\-Channel} $\ast$channel, \hyperlink{error_8h_af89348b58191950b36702ace17a79c0b}{P\-I\-C\-C\-\_\-\-Error} $\ast$error)
\item 
\hyperlink{channel_8h_ab705fb8d376f852fb1af337ac749c2e3}{P\-I\-C\-C\-\_\-\-Knowns\-Set} $\ast$ \hyperlink{channel_8c_a0914e82fe0abbb54c3d234743abe64e1}{P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-knows} (\hyperlink{channel_8h_ab705fb8d376f852fb1af337ac749c2e3}{P\-I\-C\-C\-\_\-\-Knowns\-Set} $\ast$ks, \hyperlink{error_8h_af89348b58191950b36702ace17a79c0b}{P\-I\-C\-C\-\_\-\-Error} $\ast$error)
\item 
\hyperlink{channel_8h_ab705fb8d376f852fb1af337ac749c2e3}{P\-I\-C\-C\-\_\-\-Knowns\-Set} $\ast$ \hyperlink{channel_8c_a82b5edf5813764c16e5fd91de842d0d7}{P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-forget} (\hyperlink{channel_8h_ab705fb8d376f852fb1af337ac749c2e3}{P\-I\-C\-C\-\_\-\-Knowns\-Set} $\ast$ks, \hyperlink{error_8h_af89348b58191950b36702ace17a79c0b}{P\-I\-C\-C\-\_\-\-Error} $\ast$error)
\item 
bool \hyperlink{channel_8c_a8dfc016b9a6e38200a8556da494c9538}{P\-I\-C\-C\-\_\-knowns\-\_\-register} (\hyperlink{channel_8h_ab705fb8d376f852fb1af337ac749c2e3}{P\-I\-C\-C\-\_\-\-Knowns\-Set} $\ast$ks, \hyperlink{channel_8h_a0a70def8883f1abb8e7246b3a4c9dffb}{P\-I\-C\-C\-\_\-\-Channel} $\ast$ch, \hyperlink{error_8h_af89348b58191950b36702ace17a79c0b}{P\-I\-C\-C\-\_\-\-Error} $\ast$error)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Channels.

This project is released under M\-I\-T License.

\begin{DoxyAuthor}{Author}
Maxence W\-O 

Dany S\-I\-R\-I\-P\-H\-O\-L 

Joel H\-I\-N\-G 

MickaÃ«l M\-E\-N\-U 
\end{DoxyAuthor}


\subsection{Macro Definition Documentation}
\hypertarget{channel_8c_ade120ac18f176dddff55ddb64af36027}{\index{channel.\-c@{channel.\-c}!L\-O\-C\-K\-\_\-\-C\-H\-A\-N\-N\-E\-L@{L\-O\-C\-K\-\_\-\-C\-H\-A\-N\-N\-E\-L}}
\index{L\-O\-C\-K\-\_\-\-C\-H\-A\-N\-N\-E\-L@{L\-O\-C\-K\-\_\-\-C\-H\-A\-N\-N\-E\-L}!channel.c@{channel.\-c}}
\subsubsection[{L\-O\-C\-K\-\_\-\-C\-H\-A\-N\-N\-E\-L}]{\setlength{\rightskip}{0pt plus 5cm}\#define L\-O\-C\-K\-\_\-\-C\-H\-A\-N\-N\-E\-L(
\begin{DoxyParamCaption}
\item[{}]{c}
\end{DoxyParamCaption}
)~{\bf P\-I\-C\-C\-\_\-acquire}(c-\/$>$lock);}}\label{channel_8c_ade120ac18f176dddff55ddb64af36027}
\hypertarget{channel_8c_aff8dd5b9a61142b55d554342ce512f64}{\index{channel.\-c@{channel.\-c}!R\-E\-L\-E\-A\-S\-E\-\_\-\-C\-H\-A\-N\-N\-E\-L@{R\-E\-L\-E\-A\-S\-E\-\_\-\-C\-H\-A\-N\-N\-E\-L}}
\index{R\-E\-L\-E\-A\-S\-E\-\_\-\-C\-H\-A\-N\-N\-E\-L@{R\-E\-L\-E\-A\-S\-E\-\_\-\-C\-H\-A\-N\-N\-E\-L}!channel.c@{channel.\-c}}
\subsubsection[{R\-E\-L\-E\-A\-S\-E\-\_\-\-C\-H\-A\-N\-N\-E\-L}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\-E\-L\-E\-A\-S\-E\-\_\-\-C\-H\-A\-N\-N\-E\-L(
\begin{DoxyParamCaption}
\item[{}]{c}
\end{DoxyParamCaption}
)~{\bf P\-I\-C\-C\-\_\-release}(c-\/$>$lock, N\-U\-L\-L);}}\label{channel_8c_aff8dd5b9a61142b55d554342ce512f64}


\subsection{Function Documentation}
\hypertarget{channel_8c_a82356d13ea700750660c72bdff7c8d6b}{\index{channel.\-c@{channel.\-c}!P\-I\-C\-C\-\_\-channel\-\_\-dec\-\_\-ref\-\_\-count@{P\-I\-C\-C\-\_\-channel\-\_\-dec\-\_\-ref\-\_\-count}}
\index{P\-I\-C\-C\-\_\-channel\-\_\-dec\-\_\-ref\-\_\-count@{P\-I\-C\-C\-\_\-channel\-\_\-dec\-\_\-ref\-\_\-count}!channel.c@{channel.\-c}}
\subsubsection[{P\-I\-C\-C\-\_\-channel\-\_\-dec\-\_\-ref\-\_\-count}]{\setlength{\rightskip}{0pt plus 5cm}void P\-I\-C\-C\-\_\-channel\-\_\-dec\-\_\-ref\-\_\-count (
\begin{DoxyParamCaption}
\item[{{\bf P\-I\-C\-C\-\_\-\-Channel} $\ast$}]{channel, }
\item[{{\bf P\-I\-C\-C\-\_\-\-Error} $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{channel_8c_a82356d13ea700750660c72bdff7c8d6b}
Decrements the global reference count of a channel.


\begin{DoxyParams}{Parameters}
{\em Channel} & to update \\
\hline
\end{DoxyParams}
\hypertarget{channel_8c_aaed8342d9318af6e44423bfc5ea037d1}{\index{channel.\-c@{channel.\-c}!P\-I\-C\-C\-\_\-channel\-\_\-incr\-\_\-ref\-\_\-count@{P\-I\-C\-C\-\_\-channel\-\_\-incr\-\_\-ref\-\_\-count}}
\index{P\-I\-C\-C\-\_\-channel\-\_\-incr\-\_\-ref\-\_\-count@{P\-I\-C\-C\-\_\-channel\-\_\-incr\-\_\-ref\-\_\-count}!channel.c@{channel.\-c}}
\subsubsection[{P\-I\-C\-C\-\_\-channel\-\_\-incr\-\_\-ref\-\_\-count}]{\setlength{\rightskip}{0pt plus 5cm}void P\-I\-C\-C\-\_\-channel\-\_\-incr\-\_\-ref\-\_\-count (
\begin{DoxyParamCaption}
\item[{{\bf P\-I\-C\-C\-\_\-\-Channel} $\ast$}]{channel, }
\item[{{\bf P\-I\-C\-C\-\_\-\-Error} $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{channel_8c_aaed8342d9318af6e44423bfc5ea037d1}
Increments the global reference count of a channel.


\begin{DoxyParams}{Parameters}
{\em Channel} & to update \\
\hline
\end{DoxyParams}
\hypertarget{channel_8c_ac6607a30fa1063c40a16c99eece1e54c}{\index{channel.\-c@{channel.\-c}!P\-I\-C\-C\-\_\-create\-\_\-channel@{P\-I\-C\-C\-\_\-create\-\_\-channel}}
\index{P\-I\-C\-C\-\_\-create\-\_\-channel@{P\-I\-C\-C\-\_\-create\-\_\-channel}!channel.c@{channel.\-c}}
\subsubsection[{P\-I\-C\-C\-\_\-create\-\_\-channel}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\-I\-C\-C\-\_\-\-Channel}$\ast$ P\-I\-C\-C\-\_\-create\-\_\-channel (
\begin{DoxyParamCaption}
\item[{{\bf P\-I\-C\-C\-\_\-\-Error} $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{channel_8c_ac6607a30fa1063c40a16c99eece1e54c}
Creates a channel which contains 10 commitments.


\begin{DoxyParams}{Parameters}
{\em error} & Error stack \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Created channel 
\end{DoxyReturn}
\hypertarget{channel_8c_a34ef7a647bbe6c9d81f7f76edb5931da}{\index{channel.\-c@{channel.\-c}!P\-I\-C\-C\-\_\-create\-\_\-channel\-\_\-cn@{P\-I\-C\-C\-\_\-create\-\_\-channel\-\_\-cn}}
\index{P\-I\-C\-C\-\_\-create\-\_\-channel\-\_\-cn@{P\-I\-C\-C\-\_\-create\-\_\-channel\-\_\-cn}!channel.c@{channel.\-c}}
\subsubsection[{P\-I\-C\-C\-\_\-create\-\_\-channel\-\_\-cn}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\-I\-C\-C\-\_\-\-Channel}$\ast$ P\-I\-C\-C\-\_\-create\-\_\-channel\-\_\-cn (
\begin{DoxyParamCaption}
\item[{int}]{commit\-\_\-size, }
\item[{{\bf P\-I\-C\-C\-\_\-\-Error} $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{channel_8c_a34ef7a647bbe6c9d81f7f76edb5931da}
Creates a channel which contains $<$commit\-\_\-size$>$ commitments.


\begin{DoxyParams}{Parameters}
{\em error} & Error stack \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Created channel 
\end{DoxyReturn}
\hypertarget{channel_8c_ab4695da5b9909d70ece6acf9b7393d53}{\index{channel.\-c@{channel.\-c}!P\-I\-C\-C\-\_\-create\-\_\-knowns@{P\-I\-C\-C\-\_\-create\-\_\-knowns}}
\index{P\-I\-C\-C\-\_\-create\-\_\-knowns@{P\-I\-C\-C\-\_\-create\-\_\-knowns}!channel.c@{channel.\-c}}
\subsubsection[{P\-I\-C\-C\-\_\-create\-\_\-knowns}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\-I\-C\-C\-\_\-\-Knowns}$\ast$ P\-I\-C\-C\-\_\-create\-\_\-knowns (
\begin{DoxyParamCaption}
\item[{{\bf P\-I\-C\-C\-\_\-\-Error} $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{channel_8c_ab4695da5b9909d70ece6acf9b7393d53}
Creates a new Knowns structure.


\begin{DoxyParams}{Parameters}
{\em error} & Error stack \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Created knowns structure 
\end{DoxyReturn}
\hypertarget{channel_8c_a7dbf43e2a8d14b2fa22ffcac602baa70}{\index{channel.\-c@{channel.\-c}!P\-I\-C\-C\-\_\-create\-\_\-knowns\-\_\-set@{P\-I\-C\-C\-\_\-create\-\_\-knowns\-\_\-set}}
\index{P\-I\-C\-C\-\_\-create\-\_\-knowns\-\_\-set@{P\-I\-C\-C\-\_\-create\-\_\-knowns\-\_\-set}!channel.c@{channel.\-c}}
\subsubsection[{P\-I\-C\-C\-\_\-create\-\_\-knowns\-\_\-set}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\-I\-C\-C\-\_\-\-Knowns\-Set}$\ast$ P\-I\-C\-C\-\_\-create\-\_\-knowns\-\_\-set (
\begin{DoxyParamCaption}
\item[{int}]{length, }
\item[{{\bf P\-I\-C\-C\-\_\-\-Error} $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{channel_8c_a7dbf43e2a8d14b2fa22ffcac602baa70}
Creates a new Knowns set.


\begin{DoxyParams}{Parameters}
{\em error} & Error stack \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Created knowns set 
\end{DoxyReturn}
\hypertarget{channel_8c_a8dfc016b9a6e38200a8556da494c9538}{\index{channel.\-c@{channel.\-c}!P\-I\-C\-C\-\_\-knowns\-\_\-register@{P\-I\-C\-C\-\_\-knowns\-\_\-register}}
\index{P\-I\-C\-C\-\_\-knowns\-\_\-register@{P\-I\-C\-C\-\_\-knowns\-\_\-register}!channel.c@{channel.\-c}}
\subsubsection[{P\-I\-C\-C\-\_\-knowns\-\_\-register}]{\setlength{\rightskip}{0pt plus 5cm}bool P\-I\-C\-C\-\_\-knowns\-\_\-register (
\begin{DoxyParamCaption}
\item[{{\bf P\-I\-C\-C\-\_\-\-Knowns\-Set} $\ast$}]{ks, }
\item[{{\bf P\-I\-C\-C\-\_\-\-Channel} $\ast$}]{ch, }
\item[{{\bf P\-I\-C\-C\-\_\-\-Error} $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{channel_8c_a8dfc016b9a6e38200a8556da494c9538}
Adds a channel to a knowns set.

Looks for a channel in a P\-I\-C\-C\-\_\-\-Knowns\-Set
\begin{DoxyItemize}
\item if the channel is in the P\-I\-C\-C\-\_\-\-Knowns\-Set in K\-N\-O\-W\-N-\/\-S\-T\-A\-T\-E, it returns false
\item if the channel is in the P\-I\-C\-C\-\_\-\-Knowns\-Set in F\-O\-R\-G\-E\-T-\/\-S\-T\-A\-T\-E, it switches it to K\-N\-O\-W\-N then returns false
\item else it add the channel in the P\-I\-C\-C\-\_\-\-Knowns\-Set (K\-N\-O\-W\-S-\/\-S\-T\-A\-T\-E) then returns true
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em ks} & Knowns set \\
\hline
{\em ch} & Channel to add \\
\hline
{\em error} & Error stack \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Whether the channel has been added 
\end{DoxyReturn}
\hypertarget{channel_8c_a82b5edf5813764c16e5fd91de842d0d7}{\index{channel.\-c@{channel.\-c}!P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-forget@{P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-forget}}
\index{P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-forget@{P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-forget}!channel.c@{channel.\-c}}
\subsubsection[{P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-forget}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\-I\-C\-C\-\_\-\-Knowns\-Set}$\ast$ P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-forget (
\begin{DoxyParamCaption}
\item[{{\bf P\-I\-C\-C\-\_\-\-Knowns\-Set} $\ast$}]{ks, }
\item[{{\bf P\-I\-C\-C\-\_\-\-Error} $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{channel_8c_a82b5edf5813764c16e5fd91de842d0d7}
Returns a subset of all F\-O\-R\-G\-E\-T-\/\-S\-T\-A\-T\-E in a knowns set.


\begin{DoxyParams}{Parameters}
{\em ks} & Knowns set \\
\hline
{\em error} & Error stack \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Subset of all forget state in the given set. 
\end{DoxyReturn}
\hypertarget{channel_8c_a0914e82fe0abbb54c3d234743abe64e1}{\index{channel.\-c@{channel.\-c}!P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-knows@{P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-knows}}
\index{P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-knows@{P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-knows}!channel.c@{channel.\-c}}
\subsubsection[{P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-knows}]{\setlength{\rightskip}{0pt plus 5cm}{\bf P\-I\-C\-C\-\_\-\-Knowns\-Set}$\ast$ P\-I\-C\-C\-\_\-knowns\-\_\-set\-\_\-knows (
\begin{DoxyParamCaption}
\item[{{\bf P\-I\-C\-C\-\_\-\-Knowns\-Set} $\ast$}]{ks, }
\item[{{\bf P\-I\-C\-C\-\_\-\-Error} $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{channel_8c_a0914e82fe0abbb54c3d234743abe64e1}
Returns a subset of all K\-N\-O\-W\-N-\/\-S\-T\-A\-T\-E in a knows set.


\begin{DoxyParams}{Parameters}
{\em ks} & Knowns set \\
\hline
{\em error} & Error stack \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Subset of all known state in the given set 
\end{DoxyReturn}
\hypertarget{channel_8c_a873aa501ffdedc2f345326b0ae025ec1}{\index{channel.\-c@{channel.\-c}!P\-I\-C\-C\-\_\-reclaim\-\_\-channel@{P\-I\-C\-C\-\_\-reclaim\-\_\-channel}}
\index{P\-I\-C\-C\-\_\-reclaim\-\_\-channel@{P\-I\-C\-C\-\_\-reclaim\-\_\-channel}!channel.c@{channel.\-c}}
\subsubsection[{P\-I\-C\-C\-\_\-reclaim\-\_\-channel}]{\setlength{\rightskip}{0pt plus 5cm}void P\-I\-C\-C\-\_\-reclaim\-\_\-channel (
\begin{DoxyParamCaption}
\item[{{\bf P\-I\-C\-C\-\_\-\-Channel} $\ast$}]{channel, }
\item[{{\bf P\-I\-C\-C\-\_\-\-Error} $\ast$}]{error}
\end{DoxyParamCaption}
)}}\label{channel_8c_a873aa501ffdedc2f345326b0ae025ec1}
Reclaims the given channel.


\begin{DoxyParams}{Parameters}
{\em channel} & Channel to reclaim \\
\hline
\end{DoxyParams}
